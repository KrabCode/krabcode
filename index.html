<meta charset="UTF-8">
<!doctype html>
<html>
<head>
    <link rel="stylesheet" type="text/css" href="styles.css">
    <title>krabcode</title>


    <script type="text/javascript">// <![CDATA[

      var gl;
      var canvas;
      var buffer;

      var shaderScript;
      var shaderSource;
      var vertexShader;
      var fragmentShader;

      var timeLocation;
      var timeStamp = 0;
      var resolutionLocation;

      window.onload = init;

      function init() {
    	canvas        = document.getElementById('webgl-canvas');
    	gl            = canvas.getContext('experimental-webgl');

    	canvas.width  = 640;
    	canvas.height = 480;

    	gl.viewport(0, 0, gl.drawingBufferWidth, gl.drawingBufferHeight);

      buffer = gl.createBuffer();
      gl.bindBuffer(gl.ARRAY_BUFFER, buffer);
      gl.bufferData(
        gl.ARRAY_BUFFER,
        new Float32Array([
          -1.0, -1.0,
           1.0, -1.0,
          -1.0,  1.0,
          -1.0,  1.0,
           1.0, -1.0,
           1.0,  1.0]),
        gl.STATIC_DRAW
      );

      shaderScript = document.getElementById("2d-vertex-shader");
      shaderSource = shaderScript.text;
      vertexShader = gl.createShader(gl.VERTEX_SHADER);
      gl.shaderSource(vertexShader, shaderSource);
      gl.compileShader(vertexShader);

      shaderScript   = document.getElementById("2d-fragment-shader");
      shaderSource   = shaderScript.text;
      fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);
      gl.shaderSource(fragmentShader, shaderSource);
      gl.compileShader(fragmentShader);

      program = gl.createProgram();
      gl.attachShader(program, vertexShader);
      gl.attachShader(program, fragmentShader);
      gl.linkProgram(program);
      gl.useProgram(program);

      timeLocation = gl.getUniformLocation(program, "time");
      resolutionLocation = gl.getUniformLocation(program, "resolution");
    	render();

      }

      function render() {
        window.requestAnimationFrame(render, canvas);
        gl.clearColor(1.0, 0.0, 0.0, 1.0);
        gl.clear(gl.COLOR_BUFFER_BIT);
        positionLocation = gl.getAttribLocation(program, "a_position");
        gl.uniform1f(timeLocation, timeStamp/60.0);
        timeStamp += 1;
        gl.uniform2f(resolutionLocation, canvas.width,canvas.height);
        gl.enableVertexAttribArray(positionLocation);
        gl.vertexAttribPointer(positionLocation, 2, gl.FLOAT, false, 0, 0);
        gl.drawArrays(gl.TRIANGLES, 0, 6);
      }

    // ]]>
    </script>

    <script id="2d-vertex-shader" type="x-shader/x-vertex">// <![CDATA[
    attribute vec2 a_position;
      void main() {
        gl_Position = vec4(a_position, 0, 1);
      }

    // ]]>
    </script>

    <script id="2d-fragment-shader" type="x-shader/x-fragment">// <![CDATA[
      precision highp float;
      uniform float time;
      uniform vec2 resolution;

      vec3 rgb( in vec3 hsb){
          vec3 rgb = clamp(abs(mod(hsb.x*6.0+
            vec3(0.0,4.0,2.0),6.0)-3.0)-1.0,0.0,1.0);
          rgb = rgb*rgb*(3.0-2.0*rgb);
          return hsb.z * mix(vec3(1.0), rgb, hsb.y);
      }

      mat2 rotate2d(float _angle){
          return mat2(cos(_angle),-sin(_angle),sin(_angle),cos(_angle));
      }

      void main(void) {
         float t = time*.35;
         vec2 uv = (gl_FragCoord.xy-.5*resolution.xy) / resolution.y;
         float d = 1.-length(uv);
         float a = atan(uv.y,uv.x);
         uv *= sin(a*2.);
         float ad = 1.-smoothstep(0., 0.5, length(uv));
         uv = fract(uv*8.)-.5;
         float gd = 1.-length(uv);
         vec3 rgb = rgb(vec3(1.*ad-gd*1.+t,clamp(1.-ad+gd,.0,1.),clamp(ad*2.-gd*1.25, 0., 1.)));
         gl_FragColor = vec4(rgb,1.);
      }

    // ]]>
    </script>


</head>

   <body>
       <canvas id="webgl-canvas"></canvas>
   </body>
</html>
